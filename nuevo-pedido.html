<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>ENTREGAS YA</title>

    <link rel="import" href="layout.html">
    <script src="js/myConfig.js"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <div id="nav-placeholder"></div>

    <!-- Content -->
    <div class="container-fluid mt-1" style="height: 90%;">
        Crear form para hacer pedidos

    <br>

    <!-- Testeando normalizaciÃ³n -->
    <label for="calle">Calle</label>
    <input type="text" id="calle" value="Loria">

    <label for="altura">Altura</label>
    <input type="number" id="altura" value="300">

    <label for="partido">Partido</label>
    <input type="text" id="partido" value="Lomas">

    <button type="submit" onclick="normalizar();obtenerRepartidoresDisponibles();">Validar</button>

    </div>

    <script>
        urlNormalizador = Config.urlNormalizador;
        urlEntregasYa = Config.urlEntregasYa;
        urlRepartidores = '/deliverydrivers/';

        function normalizar() {

            calle = $('#calle').val();
            altura = $('#altura').val();
            partido = $('#partido').val();

            if (altura)
                altura = ' ' + altura;

            if (partido)
                partido = ', ' + partido;

            // requestDireccion(calle, altura, partido).then(log);
            requestDireccion(calle, altura, partido).done(log);

        }

        function requestDireccion(calle, altura, partido) {
            return $.ajax(urlNormalizador + calle + altura + partido);
        }
        
        function log(response) {
            ret = response.errorMessage ? response.errorMessage : response;
            console.log(ret);
        }

        function obtenerRepartidoresDisponibles() {
            requestRepartidor().done(log);
        }

        function requestRepartidor(repartidor_id) {
            repartidor_id = repartidor_id ? repartidor_id : '';
            return $.ajax(urlEntregasYa + urlRepartidores + repartidor_id);
        }
        </script>

</body>
</html>